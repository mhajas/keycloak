<#import "/templates/guide.adoc" as tmpl>
<#import "/templates/kc.adoc" as kc>
<#import "/templates/options.adoc" as opts>
<#import "/templates/links.adoc" as links>

<@tmpl.guide
title="Enabling {project_name} Event Metrics"
summary="Learn how to enable and use {project_name} Event Metrics"
includedOptions="metrics-enabled">

== Enable event metrics

- To enable the event listener via the GUI interface, go to
. Click *Realm settings* in the menu.
. Click the *Events* tab.
. The *Event Listeners* configuration should have an entry named `micrometer-metrics`.

- To enable the event listener via the Keycloak CLI, such as when building a Docker container, use these commands.

* Linux:
+
[options="nowrap"]
----
$ kcadm.sh update events/config -r demorealm -s 'eventsListeners+=["micrometer-metrics"]'
----
* Windows:
+
[options="nowrap"]
----
c:\> kcadm update events/config -r demorealm -s "eventsListeners+=[\"micrometer-metrics\"]"
----

The snippet below is an example of a response:

[source]
----

# TYPE keycloak_simple_events counter
# HELP keycloak_simple_events The total number of Keycloak events
keycloak_simple_events_total{event="update_password",realm="master"} 1.0
keycloak_simple_events_total{event="update_credential",realm="master"} 1.0
# TYPE keycloak_events counter
# HELP keycloak_events The total number of Keycloak events
keycloak_events_total{client_id="security-admin-console",error="",event="code_to_token",idp="",realm="master"} 6.0
keycloak_events_total{client_id="security-admin-console",error="",event="logout",idp="",realm="master"} 2.0
keycloak_events_total{client_id="security-admin-console",error="",event="login",idp="",realm="master"} 6.0
keycloak_events_total{client_id="security-admin-console",error="",event="refresh_token",idp="",realm="master"} 2.0
keycloak_events_total{client_id="client_not_found",error="client_not_found",event="login_error",idp="",realm="master"} 1.0
...
----


</@tmpl.guide>
